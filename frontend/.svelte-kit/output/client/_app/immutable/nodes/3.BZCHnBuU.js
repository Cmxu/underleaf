import{p as K,b as Le,_ as Je}from"../chunks/CjQl7U_1.js";import{f as L,a as w,d as ge,t as qe}from"../chunks/BygsjDEO.js";import"../chunks/DL-nje0L.js";import{o as Se}from"../chunks/BypnEDLT.js";import{h as J,a as Qe,b as Ze,o as a,M as Q,r as $e,c as et,d as ye,s as we,e as pe,i as ae,al as tt,f as Me,g as Pe,p as at,ap as Ie,ag as rt,O as R,av as ke,aw as me,a9 as Fe,ax as lt,ay as nt,az as st,ao as it,aA as ot,aB as vt,aC as dt,aD as ct,ai as ft,C as ne,A as c,B as f,F as H,G as se,D as re,I as F,aE as Ae,aF as Ue,Q as D,q as ze,aG as ut,P as Ne,$ as pt}from"../chunks/B9Ev1FTx.js";import{s as Y,e as q,h as mt}from"../chunks/BVz-vWpg.js";import{i as z}from"../chunks/DKDRjB9S.js";import{i as xe}from"../chunks/DorS8xa2.js";import{g as Ce}from"../chunks/CH0z8zM7.js";import{a as le,s as Ee}from"../chunks/nXy1FWTK.js";function Re(v,t){return t}function gt(v,t,e,n){for(var o=[],l=t.length,i=0;i<l;i++)st(t[i].e,o,!0);var b=l>0&&o.length===0&&e!==null;if(b){var d=e.parentNode;it(d),d.append(e),n.clear(),$(v,t[0].prev,t[l-1].next)}ot(o,()=>{for(var _=0;_<l;_++){var s=t[_];b||(n.delete(s.k),$(v,s.prev,s.next)),vt(s.e,!b)}})}function Be(v,t,e,n,o,l=null){var i=v,b={flags:t,items:new Map,first:null};J&&Qe();var d=null,_=!1,s=Q(()=>{var y=e();return rt(y)?y:y==null?[]:Ie(y)});Ze(()=>{var y=a(s),m=y.length;if(_&&m===0)return;_=m===0;let C=!1;if(J){var u=$e(i)===et;u!==(m===0)&&(i=ye(),we(i),pe(!1),C=!0)}if(J){for(var E=null,M,g=0;g<m;g++){if(ae.nodeType===8&&ae.data===tt){i=ae,C=!0,pe(!1);break}var h=y[g],S=n(h,g);M=je(ae,b,E,null,h,S,g,o,t,e),b.items.set(S,M),E=M}m>0&&we(ye())}J||xt(y,b,i,o,t,n,e),l!==null&&(m===0?d?Me(d):d=Pe(()=>l(i)):d!==null&&at(d,()=>{d=null})),C&&pe(!0),a(s)}),J&&(i=ae)}function xt(v,t,e,n,o,l,i){var b=v.length,d=t.items,_=t.first,s=_,y,m=null,C=[],u=[],E,M,g,h;for(h=0;h<b;h+=1){if(E=v[h],M=l(E,h),g=d.get(M),g===void 0){var S=s?s.e.nodes_start:e;m=je(S,t,m,m===null?t.first:m.next,E,M,h,n,o,i),d.set(M,m),C=[],u=[],s=m.next;continue}if(ht(g,E,h),g.e.f&me&&Me(g.e),g!==s){if(y!==void 0&&y.has(g)){if(C.length<u.length){var p=u[0],k;m=p.prev;var A=C[0],P=C[C.length-1];for(k=0;k<C.length;k+=1)Te(C[k],p,e);for(k=0;k<u.length;k+=1)y.delete(u[k]);$(t,A.prev,P.next),$(t,m,A),$(t,P,p),s=p,m=P,h-=1,C=[],u=[]}else y.delete(g),Te(g,s,e),$(t,g.prev,g.next),$(t,g,m===null?t.first:m.next),$(t,m,g),m=g;continue}for(C=[],u=[];s!==null&&s.k!==M;)s.e.f&me||(y??=new Set).add(s),u.push(s),s=s.next;if(s===null)continue;g=s}C.push(g),m=g,s=g.next}if(s!==null||y!==void 0){for(var T=y===void 0?[]:Ie(y);s!==null;)s.e.f&me||T.push(s),s=s.next;var U=T.length;if(U>0){var I=null;gt(t,T,I,d)}}Fe.first=t.first&&t.first.e,Fe.last=m&&m.e}function ht(v,t,e,n){nt(v.v,t),v.i=e}function je(v,t,e,n,o,l,i,b,d,_){var s=(d&dt)!==0,y=(d&ct)===0,m=s?y?R(o):ke(o):o,C=d&lt?ke(i):i,u={i:C,v:m,k:l,a:null,e:null,prev:e,next:n};try{return u.e=Pe(()=>b(v,m,C,_),J),u.e.prev=e&&e.e,u.e.next=n&&n.e,e===null?t.first=u:(e.next=u,e.e.next=u.e),n!==null&&(n.prev=u,n.e.prev=u.e),u}finally{}}function Te(v,t,e){for(var n=v.next?v.next.e.nodes_start:e,o=t?t.e.nodes_start:e,l=v.e.nodes_start;l!==n;){var i=ft(l);o.before(l),l=i}}function $(v,t,e){t===null?v.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}const De=[...` 	
\r\fÂ \v\uFEFF`];function _t(v,t,e){var n=""+v;if(e){for(var o in e)if(e[o])n=n?n+" "+o:o;else if(n.length)for(var l=o.length,i=0;(i=n.indexOf(o,i))>=0;){var b=i+l;(i===0||De.includes(n[i-1]))&&(b===n.length||De.includes(n[b]))?n=(i===0?"":n.substring(0,i))+n.substring(b+1):i=b}}return n===""?null:n}function bt(v,t){return v==null?null:String(v)}function yt(v,t,e,n,o,l){var i=v.__className;if(J||i!==e||i===void 0){var b=_t(e,n,l);(!J||b!==v.getAttribute("class"))&&(b==null?v.removeAttribute("class"):v.className=b),v.__className=e}else if(l&&o!==l)for(var d in l){var _=!!l[d];(o==null||_!==!!o[d])&&v.classList.toggle(d,_)}return l}function wt(v,t,e,n){var o=v.__style;if(J||o!==t){var l=bt(t);(!J||l!==v.getAttribute("style"))&&(l==null?v.removeAttribute("style"):v.style.cssText=l),v.__style=t}return n}var kt=L('<button class="w-full text-left px-4 py-1 hover:bg-gray-700 transition-colors flex items-center text-sm text-gray-300"><span class="w-4 text-xs"> </span> <span class="ml-2 truncate"> </span></button> <!>',1),Ft=L('<span class="text-xs text-gray-500 group-hover:text-gray-400 ml-2 flex-shrink-0"> </span>'),Ct=L('<button><div class="flex items-center min-w-0"><span class="w-4 text-xs"> </span> <span class="ml-2 truncate"> </span></div> <!></button>'),Et=L('<div class="select-none"><!></div>');function He(v,t){ne(t,!1);let e=K(t,"item",8),n=K(t,"depth",8,0),o=K(t,"expandedDirs",8),l=K(t,"selectedFile",8),i=K(t,"onToggleDirectory",8),b=K(t,"onSelectFile",8);function d(u){if(u.type==="directory")return o().has(u.path)?"ğŸ“‚":"ğŸ“";switch(u.name.split(".").pop()?.toLowerCase()){case"tex":return"ğŸ“„";case"pdf":return"ğŸ“‹";case"png":case"jpg":case"jpeg":case"gif":return"ğŸ–¼ï¸";case"md":return"ğŸ“";case"json":return"âš™ï¸";case"bib":return"ğŸ“š";default:return"ğŸ“„"}}function _(u){return u<1024?`${u} B`:u<1024*1024?`${(u/1024).toFixed(1)} KB`:`${(u/(1024*1024)).toFixed(1)} MB`}xe();var s=Et(),y=c(s);{var m=u=>{var E=kt(),M=re(E),g=c(M),h=c(g,!0);f(g);var S=F(g,2),p=c(S,!0);f(S),f(M);var k=F(M,2);{var A=P=>{var T=ge(),U=re(T);Be(U,1,()=>e().children,Re,(I,V)=>{var B=ge(),X=re(B);const W=Q(()=>n()+1);He(X,{get item(){return a(V)},get depth(){return a(W)},get expandedDirs(){return o()},get selectedFile(){return l()},get onToggleDirectory(){return i()},get onSelectFile(){return b()}}),w(I,B)}),w(P,T)};z(k,P=>{o().has(e().path)&&e().children&&P(A)})}H(P=>{Y(h,P),Y(p,e().name)},[()=>d(e())],Q),q("click",M,()=>i()(e().path)),w(u,E)},C=u=>{var E=Ct();let M;var g=c(E),h=c(g),S=c(h,!0);f(h);var p=F(h,2),k=c(p,!0);f(p),f(g);var A=F(g,2);{var P=T=>{var U=Ft(),I=c(U,!0);f(U),H(V=>Y(I,V),[()=>_(e().size)],Q),w(T,U)};z(A,T=>{e().size!==void 0&&T(P)})}f(E),H((T,U)=>{M=yt(E,1,"w-full text-left px-4 py-1 hover:bg-gray-700 transition-colors flex items-center justify-between text-sm group",null,M,T),Y(S,U),Y(k,e().name)},[()=>({"bg-blue-600":l()===e().path,"text-white":l()===e().path,"text-gray-300":l()!==e().path}),()=>d(e())],Q),q("click",E,()=>b()(e().path)),w(u,E)};z(y,u=>{e().type==="directory"?u(m):u(C,!1)})}f(s),H(()=>wt(s,`margin-left: ${n()*16}px`)),w(v,s),se()}var Tt=L('<p class="text-xs text-gray-400 mt-1 truncate"> </p>'),Dt=L('<div class="p-4 text-center"><div class="loading-spinner mx-auto mb-2"></div> <p class="text-gray-400 text-sm">Loading files...</p></div>'),Lt=L('<div class="p-4 text-center"><p class="text-red-400 text-sm mb-2">âš ï¸ Error loading files</p> <p class="text-gray-400 text-xs"> </p> <button class="mt-2 text-blue-400 hover:text-blue-300 text-sm underline">Retry</button></div>'),St=L('<div class="p-4 text-center text-gray-400 text-sm"><p>ğŸ“‚</p> <p class="mt-2">No repository loaded</p></div>'),Mt=L('<div class="p-4 text-center text-gray-400 text-sm"><p>ğŸ“­</p> <p class="mt-2">Repository is empty</p></div>'),Pt=L('<div class="h-full flex flex-col bg-dark-800"><div class="p-4 border-b border-gray-700"><h3 class="text-gray-300 font-medium flex items-center"><span class="mr-2">ğŸ“</span> File Explorer</h3> <!></div> <div class="flex-1 overflow-y-auto"><!></div></div>');function It(v,t){ne(t,!1);let e=K(t,"repoName",8,null),n=K(t,"onFileSelect",8,()=>{}),o=R([]),l=R(new Set),i=R(null),b=R(!1),d=R(null);Se(()=>{e()&&_()});async function _(){if(e()){D(b,!0),D(d,null);try{const p=await le.getFileTree(e());D(o,p.tree)}catch(p){D(d,p instanceof Error?p.message:"Failed to load file tree")}finally{D(b,!1)}}}function s(p){a(l).has(p)?a(l).delete(p):a(l).add(p),D(l,new Set(a(l)))}function y(p){D(i,p),n()(p)}Ae(()=>ze(e()),()=>{e()&&_()}),Ue(),xe();var m=Pt(),C=c(m),u=F(c(C),2);{var E=p=>{var k=Tt(),A=c(k,!0);f(k),H(()=>Y(A,e())),w(p,k)};z(u,p=>{e()&&p(E)})}f(C);var M=F(C,2),g=c(M);{var h=p=>{var k=Dt();w(p,k)},S=(p,k)=>{{var A=T=>{var U=Lt(),I=F(c(U),2),V=c(I,!0);f(I);var B=F(I,2);f(U),H(()=>Y(V,a(d))),q("click",B,_),w(T,U)},P=(T,U)=>{{var I=B=>{var X=St();w(B,X)},V=(B,X)=>{{var W=j=>{var G=Mt();w(j,G)},O=j=>{var G=ge(),ie=re(G);Be(ie,1,()=>a(o),Re,(oe,ve)=>{He(oe,{get item(){return a(ve)},depth:0,get expandedDirs(){return a(l)},get selectedFile(){return a(i)},onToggleDirectory:s,onSelectFile:y})}),w(j,G)};z(B,j=>{a(o).length===0?j(W):j(O,!1)},X)}};z(T,B=>{e()?B(V,!1):B(I)},U)}};z(p,T=>{a(d)?T(A):T(P,!1)},k)}};z(g,p=>{a(b)?p(h):p(S,!1)})}f(M),f(m),w(v,m),se()}var At=L('<div class="absolute inset-0 flex items-center justify-center bg-gray-50"><div class="text-center"><div class="loading-spinner mx-auto mb-4 w-8 h-8"></div> <p class="text-gray-600">Compiling PDF...</p></div></div>'),Ut=L('<div class="absolute inset-0 flex items-center justify-center bg-red-50"><div class="text-center max-w-md mx-auto p-6"><svg class="w-16 h-16 mx-auto mb-4 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg> <h3 class="text-lg font-medium text-red-800 mb-2">Compilation Error</h3> <p class="text-red-600 text-sm mb-4"> </p> <p class="text-xs text-gray-500">Install LaTeX (TeX Live) or Docker for full compilation support.</p></div></div>'),zt=L('<div class="absolute inset-0 flex items-center justify-center"><div class="text-center text-gray-600"><svg class="w-16 h-16 mx-auto mb-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p class="text-lg font-medium mb-2">PDF Preview</p> <p class="text-sm">Compile your LaTeX document to see the preview</p></div></div>'),Nt=L('<div class="absolute inset-0 flex items-center justify-center bg-yellow-50"><div class="text-center max-w-md mx-auto p-6"><svg class="w-16 h-16 mx-auto mb-4 text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg> <h3 class="text-lg font-medium text-yellow-800 mb-2">PDF Load Error</h3> <p class="text-yellow-700 text-sm mb-4">Unable to display the PDF file.</p> <button class="text-blue-600 hover:text-blue-500 underline text-sm">Try Again</button></div></div>'),Rt=L('<iframe class="w-full h-full border-0" title="PDF Preview"></iframe>'),Bt=L('<div class="bg-gray-200 px-4 py-2 border-t border-gray-300 flex items-center justify-between text-sm"><span class="text-gray-600">PDF Preview</span> <div class="flex items-center space-x-2"><button class="text-gray-600 hover:text-gray-800 transition-colors" title="Refresh PDF" aria-label="Refresh PDF"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg></button> <a target="_blank" rel="noopener noreferrer" class="text-gray-600 hover:text-gray-800 transition-colors" title="Open in new tab" aria-label="Open PDF in new tab"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg></a></div></div>'),jt=L('<div class="h-full flex flex-col bg-gray-100"><div class="flex-1 relative"><!></div> <!></div>');function Ht(v,t){ne(t,!1);let e=K(t,"pdfUrl",8,null),n=K(t,"isLoading",8,!1),o=K(t,"error",8,null),l=R(),i=R(!1);function b(){D(i,!1)}function d(){D(i,!0)}function _(){if(a(l)&&e()){const h=Date.now(),S=`/pdfjs/web/viewer.html?file=${encodeURIComponent(e())}&t=${h}`;ut(l,a(l).src=S)}}function s(h){return`/pdfjs/web/viewer.html?file=${encodeURIComponent(h)}`}Ae(()=>(ze(e()),a(l)),()=>{e()&&a(l)&&_()}),Ue();var y=jt(),m=c(y),C=c(m);{var u=h=>{var S=At();w(h,S)},E=(h,S)=>{{var p=A=>{var P=Ut(),T=c(P),U=F(c(T),4),I=c(U,!0);f(U),Ne(2),f(T),f(P),H(()=>Y(I,o())),w(A,P)},k=(A,P)=>{{var T=I=>{var V=zt();w(I,V)},U=(I,V)=>{{var B=W=>{var O=Nt(),j=c(O),G=F(c(j),6);f(j),f(O),q("click",G,_),w(W,O)},X=W=>{var O=Rt();Le(O,j=>D(l,j),()=>a(l)),H(j=>Ee(O,"src",j),[()=>s(e())],Q),q("load",O,b),q("error",O,d),w(W,O)};z(I,W=>{a(i)?W(B):W(X,!1)},V)}};z(A,I=>{e()?I(U,!1):I(T)},P)}};z(h,A=>{o()?A(p):A(k,!1)},S)}};z(C,h=>{n()?h(u):h(E,!1)})}f(m);var M=F(m,2);{var g=h=>{var S=Bt(),p=F(c(S),2),k=c(p),A=F(k,2);f(p),f(S),H(P=>Ee(A,"href",P),[()=>s(e())],Q),q("click",k,_),w(h,S)};z(M,h=>{e()&&!n()&&!o()&&h(g)})}f(y),w(v,y),se()}var Vt=L('<p class="text-sm text-gray-400"> </p>'),Ot=L('<span class="text-orange-400" title="Unsaved changes">â—</span>'),Wt=L('<div class="text-sm text-gray-300 flex items-center space-x-2"><span>ğŸ“„</span> <span> </span> <!></div>'),Yt=L('<div class="text-green-400 text-sm flex items-center space-x-2"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"></path></svg> <span>Compiled successfully</span></div>'),Gt=L('<button class="text-gray-400 hover:text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed" title="Save file (Ctrl+S)" aria-label="Save file"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12"></path></svg></button>'),Kt=L('<div class="flex items-center space-x-2"><div class="loading-spinner w-4 h-4"></div> <span>Compiling...</span></div>'),Xt=L('<div class="bg-dark-700 px-4 py-2 border-b border-gray-600 text-sm text-gray-300 flex items-center justify-between"><span> </span> <span class="text-xs text-gray-500">Auto-save enabled</span></div>'),Jt=L('<div class="bg-red-500/10 border-t border-red-500/20 p-4 text-red-300"><div class="flex items-start space-x-2"><svg class="w-5 h-5 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z"></path></svg> <div><p class="font-medium">Compilation Error</p> <p class="text-sm text-red-200 mt-1"> </p></div></div></div>'),qt=L('<div class="h-screen flex flex-col bg-dark-900"><header class="bg-dark-800 border-b border-gray-700 px-6 py-4 flex items-center justify-between"><div class="flex items-center space-x-4"><button class="text-gray-300 hover:text-white transition-colors" aria-label="Go back to home"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg></button> <div><h1 class="text-xl font-semibold text-white">Underleaf Editor</h1> <!></div></div> <div class="flex items-center space-x-4"><!> <!> <!> <button class="btn-primary px-6 py-2 text-sm disabled:opacity-50"><!></button></div></header> <div class="flex-1 flex overflow-hidden"><aside class="w-64 bg-dark-800 border-r border-gray-700 overflow-y-auto"><!></aside> <div class="flex-1 flex flex-col"><!> <div class="flex-1 relative"><div class="w-full h-full"></div></div> <!></div> <aside class="w-1/2 border-l border-gray-700"><!></aside></div></div>');function ia(v,t){ne(t,!1);let e=R(),n=null,o=null,l=R(!1),i=R(null),b=R(!1),d=R(null),_=R(null),s=R(!1),y=null,m=R(null);Se(async()=>{const r=new URLSearchParams(window.location.search);if(D(d,r.get("repo")||localStorage.getItem("currentRepo")),!a(d)){Ce("/");return}await C()});async function C(){try{const r=await Je(()=>import("../chunks/DJPvpCLQ.js"),[],import.meta.url);r.default.config({paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs"}}),o=await r.default.init(),o.languages.getLanguages().find(x=>x.id==="latex")||(o.languages.register({id:"latex"}),o.languages.setMonarchTokensProvider("latex",{tokenizer:{root:[[/\\[a-zA-Z@]+/,"keyword"],[/\{[^}]*\}/,"string"],[/%.*$/,"comment"],[/\$[^$]*\$/,"number"],[/\$\$[^$]*\$\$/,"number"]]}})),n=o.editor.create(a(e),{value:`% Welcome to Underleaf!
% Select a file from the file tree to start editing

\\documentclass{article}
\\usepackage[utf8]{inputenc}
\\usepackage[T1]{fontenc}
\\usepackage{amsmath}
\\usepackage{amsfonts}
\\usepackage{amssymb}
\\usepackage{graphicx}

\\title{Your Document Title}
\\author{Your Name}
\\date{\\today}

\\begin{document}

\\maketitle

\\section{Introduction}

Your content here...

\\end{document}`,language:"latex",theme:"vs-dark",fontSize:14,fontFamily:"JetBrains Mono, Consolas, Monaco, monospace",wordWrap:"on",automaticLayout:!0,minimap:{enabled:!1},scrollBeyondLastLine:!1,renderLineHighlight:"line",lineNumbers:"on",folding:!0,bracketMatching:"always",autoIndent:"full",tabSize:2,insertSpaces:!0}),n.onDidChangeModelContent(()=>{D(s,!0),y&&clearTimeout(y),y=setTimeout(()=>{a(_)&&a(s)&&E()},2e3)}),n.addCommand(o.KeyMod.CtrlCmd|o.KeyCode.KeyS,()=>{E()})}catch(r){console.error("Failed to initialize Monaco Editor:",r)}}async function u(r){if(a(d))try{const x=await le.getFileContent(a(d),r);if(n){n.setValue(x.content),D(_,r),D(s,!1),D(i,null),D(b,!1);const N=r.split(".").pop()?.toLowerCase(),Z=N==="tex"?"latex":N==="bib"?"bibtex":N==="md"?"markdown":N==="json"?"json":"plaintext";o.editor.setModelLanguage(n.getModel(),Z)}}catch(x){D(i,x instanceof Error?x.message:"Failed to load file")}}async function E(){if(!(!a(d)||!a(_)||!n))try{const r=n.getValue();await le.saveFile(a(d),a(_),r),D(s,!1),y&&(clearTimeout(y),y=null)}catch(r){console.error("Failed to save file:",r)}}async function M(){if(a(d)){D(l,!0),D(i,null),D(b,!1),a(_)&&a(s)&&await E();try{const r=a(_)?.endsWith(".tex")?a(_):"main.tex",x=await le.compileRepo(a(d),"anonymous",r);D(b,!0),x.pdfUrl&&D(m,x.pdfUrl.startsWith("http")?x.pdfUrl:`http://localhost:3001${x.pdfUrl}`),console.log("Compilation successful:",x)}catch(r){D(i,r instanceof Error?r.message:"Compilation failed")}finally{D(l,!1)}}}function g(){a(d)&&localStorage.removeItem("currentRepo"),Ce("/")}function h(r){return r?r.split("/").pop()||r:"Untitled"}xe();var S=qt();mt(r=>{pt.title="Editor - Underleaf"});var p=c(S),k=c(p),A=c(k),P=F(A,2),T=F(c(P),2);{var U=r=>{var x=Vt(),N=c(x,!0);f(x),H(()=>Y(N,a(d))),w(r,x)};z(T,r=>{a(d)&&r(U)})}f(P),f(k);var I=F(k,2),V=c(I);{var B=r=>{var x=Wt(),N=F(c(x),2),Z=c(N,!0);f(N);var ee=F(N,2);{var ue=te=>{var Xe=Ot();w(te,Xe)};z(ee,te=>{a(s)&&te(ue)})}f(x),H(te=>Y(Z,te),[()=>h(a(_))],Q),w(r,x)};z(V,r=>{a(_)&&r(B)})}var X=F(V,2);{var W=r=>{var x=Yt();w(r,x)};z(X,r=>{a(b)&&r(W)})}var O=F(X,2);{var j=r=>{var x=Gt();H(()=>x.disabled=!a(s)),q("click",x,E),w(r,x)};z(O,r=>{a(_)&&r(j)})}var G=F(O,2),ie=c(G);{var oe=r=>{var x=Kt();w(r,x)},ve=r=>{var x=qe("Compile PDF");w(r,x)};z(ie,r=>{a(l)?r(oe):r(ve,!1)})}f(G),f(I),f(p);var he=F(p,2),de=c(he),Ve=c(de);It(Ve,{get repoName(){return a(d)},onFileSelect:u}),f(de);var ce=F(de,2),_e=c(ce);{var Oe=r=>{var x=Xt(),N=c(x),Z=c(N);f(N),Ne(2),f(x),H(ee=>Y(Z,`Editing: ${ee??""}`),[()=>h(a(_))],Q),w(r,x)};z(_e,r=>{a(_)&&r(Oe)})}var fe=F(_e,2),We=c(fe);Le(We,r=>D(e,r),()=>a(e)),f(fe);var Ye=F(fe,2);{var Ge=r=>{var x=Jt(),N=c(x),Z=F(c(N),2),ee=F(c(Z),2),ue=c(ee,!0);f(ee),f(Z),f(N),f(x),H(()=>Y(ue,a(i))),w(r,x)};z(Ye,r=>{a(i)&&r(Ge)})}f(ce);var be=F(ce,2),Ke=c(be);Ht(Ke,{get pdfUrl(){return a(m)},get isLoading(){return a(l)},get error(){return a(i)}}),f(be),f(he),f(S),H(()=>G.disabled=a(l)||!a(d)),q("click",A,g),q("click",G,M),w(v,S),se()}export{ia as component};
//# sourceMappingURL=3.BZCHnBuU.js.map
